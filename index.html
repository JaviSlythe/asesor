<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Asesor en Estrategia de Sustentabilidad Empresarial</title>
  <link rel="icon" href="HINS logo color.png" type="image/png">
  <!-- Importar la fuente Montserrat -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* Paleta de colores:
       - Verde oscuro: #436C3B (títulos, borde del formulario)
       - Verde medio: #7EA54A (fondos y detalles)
       - Verde claro: #B9D986 (fondo de la página)
       - Amarillo verdoso: #DBDB81 (elementos destacados, botones)
       - Gris medio: #959595 (bordes suaves, textos secundarios)
       - Gris oscuro: #323232 (texto principal y detalles contrastantes)
    */
    body {
      font-family: 'Montserrat', sans-serif;
      color: #323232;
      margin: 0;
      padding: 0;
      background-color: #B9D986;
    }
    
    header {
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: center; 
      padding: 7px 0;
      background-color: #7EA54A;
      border-bottom: 3px solid #436C3B;
      box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.1);
      height: 100px; 
      margin-bottom: 50px;
    }
    
    header img {
      max-height: 70px;
    }
    
    main {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    h1 {
      font-size: 2em;
      text-align: center;
      margin: 20px 0;
      color: #436C3B;
    }
    
    h2 {
      font-size: 1.5em;
      text-align: center;
      color: #436C3B;
    }
    
    /* Sección para el registro de actividades */
    #time-tracking {
      background-color: #DBDB81;
      padding: 20px;
      margin: 20px auto;
      width: 80%;
      border-radius: 8px;
      box-shadow: 2px 2px 8px rgba(0,0,0,0.2);
      border: 2px solid #436C3B;
    }
    
    #time-tracking h2 {
      color: #436C3B;
    }
    
    #time-tracking form label {
      display: inline-block;
      width: 150px;
      margin-top: 10px;
      color: #436C3B;
    }
    
    #time-tracking form input {
      margin-top: 10px;
      border: 1px solid #436C3B;
      padding: 5px;
      border-radius: 4px;
    }
    
    #time-tracking table {
      width: 100%;
      margin-top: 15px;
      border-collapse: collapse;
    }
    
    #time-tracking table, 
    #time-tracking th, 
    #time-tracking td {
      border: 1px solid #959595;
      padding: 8px;
      text-align: center;
    }
    
    #time-tracking th {
      background-color: #7EA54A;
      color: #323232;
    }
    
    /* Botones generales */
    button {
      background-color: #DBDB81;
      color: #323232;
      border: none;
      border-radius: 5px;
      padding: 10px 20px;
      cursor: pointer;
      font-family: 'Montserrat', sans-serif;
      font-size: 16px;
      transition: background-color 0.3s ease;
      margin-top: 10px;
    }
    
    button:hover {
      background-color: #7EA54A;
    }
    
    footer {
      text-align: center;
      font-size: 0.8em;
      color: #323232;
      margin-top: 10px;
      padding: 10px;
    }
    
    /* Estilos del Pop-Up */
    .popup {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
      z-index: 10000; 
    }
    
    #Gif {
      width: 70%;
      height: auto;
      border-radius: 8px;
      animation: zoomIn 0.5s ease-in-out;
    }
    
    @keyframes zoomIn {
      from {
        transform: scale(0.90);
        opacity: 0;
      }
      to {
        transform: scale(1);
        opacity: 1;
      }
    }
    
    .popup-content {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      width: 500px;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      position: relative;
      font-family: 'Montserrat', sans-serif;
    }
    
    .popup-content h2 {
      margin-top: 0;
      color: #436C3B;
    }
    
    .popup-content p {
      margin: 10px 0;
      line-height: 1.5;
      color: #323232;
    }
    
    .popup .continue-button {
      margin-top: 20px;
      padding: 10px 20px;
      background-color: #DBDB81;
      color: #323232;
      border: none;
      font-weight: bold;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    
    .popup .continue-button:hover {
      background-color: #7EA54A;
    }
    
    .popup .close {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 24px;
      cursor: pointer;
      color: #323232;
    }
    
    /* Responsive */
    @media (max-width: 600px) {
      body {
        padding: 10px;
      }
      
      header {
        flex-direction: column;
        height: auto;
        background: #7EA54A;
      }
      
      header img {
        max-height: 50px;
      }
      
      h1 {
        font-size: 1.5em;
      }
      
      h2 {
        font-size: 1.3em;
      }
      
      #time-tracking {
        width: 95%;
      }
      
      footer {
        font-size: 0.7em;
        padding: 5px;
      }
      
      .popup-content {
        font-size: 0.9em;
      }
    }
  </style>
</head>
<body>
  <header>
    <img src="HINS logo color.png" alt="HINS Logo">
  </header>
  <main>
    <h1>Asesor en Estrategia de Sustentabilidad Empresarial</h1>
    
    <!-- Sección para el registro de actividades -->
    <section id="time-tracking">
      <h2>Registro de Actividades Diarias</h2>
      <form id="activityForm">
        <label for="project">Proyecto:</label>
        <input type="text" id="project" name="project" required><br>
        
        <label for="hours">Horas dedicadas:</label>
        <input type="number" id="hours" name="hours" step="0.1" required><br>
        
        <label for="taskType">Tipo de Tarea:</label>
        <input type="text" id="taskType" name="taskType" required><br>
        
        <button type="button" onclick="addRecord()">Agregar Registro</button>
      </form>
      
      <h3>Registros de Hoy</h3>
      <table id="recordsTable">
        <thead>
          <tr>
            <th>Proyecto</th>
            <th>Horas</th>
            <th>Tipo de Tarea</th>
          </tr>
        </thead>
        <tbody>
          <!-- Se agregarán los registros aquí -->
        </tbody>
      </table>
      
      <button type="button" onclick="generateMonthlyReport()">Generar Informe Mensual</button>
      
      <h3>Informe Mensual</h3>
      <table id="monthlyReportTable">
        <thead>
          <tr>
            <th>Proyecto</th>
            <th>Tipo de Tarea</th>
            <th>Total Horas</th>
          </tr>
        </thead>
        <tbody>
          <!-- Se mostrará el informe aquí -->
        </tbody>
      </table>
      
      <button type="button" onclick="exportTableToCSV('informe_mensual.csv')">Exportar a Excel</button>
    </section>
  </main>
  
  <footer>
    que es un desarrollo en prueba del laboratorio de innovación de HINS y puede cometer errores
  </footer>
  
  <!-- Pop-Up -->
  <div id="popup" class="popup">
    <div class="popup-content">
      <span id="closePopup" class="close">&times;</span>
      <h2>¡Importante!</h2>
      <p><b>Antes de comenzar, tenga en cuenta las siguientes indicaciones:</b></p>
      <p><b>1. Configure su conversación:</b> Haga clic en <b>"Chat now"</b> y seleccione el idioma <b>"Spanish"</b> para comenzar.</p>
      <img id="Gif" src="https://i.gifer.com/3OsMY.gif" alt="Ejemplo de Configuración">
      <p><b>2. Active su micrófono desde el navegador:</b> Para aceptar los permisos, haga clic en <b>"Permitir mientras visitas el sitio"</b>. Este ajuste se realiza por única vez.</p>
      <button id="continueButton" class="continue-button">Continuar</button>
    </div>
  </div>
  
  <!-- Script del Pop-Up -->
  <script>
    window.addEventListener('load', () => {
      document.getElementById('popup').style.display = 'flex';
    });
  
    document.getElementById('closePopup').addEventListener('click', () => {
      document.getElementById('popup').style.display = 'none';
    });
  
    document.getElementById('continueButton').addEventListener('click', () => {
      document.getElementById('popup').style.display = 'none';
    });
  </script>
  
  <!-- Lógica para el registro y generación de informes -->
  <script>
    let records = []; // Almacena los registros diarios
  
    function addRecord() {
      const project = document.getElementById('project').value.trim();
      const hours = parseFloat(document.getElementById('hours').value);
      const taskType = document.getElementById('taskType').value.trim();
      
      if (!project || isNaN(hours) || !taskType) {
        alert("Por favor, complete todos los campos.");
        return;
      }
      
      const record = { project, hours, taskType };
      records.push(record);
      updateRecordsTable();
      document.getElementById('activityForm').reset();
    }
    
    function updateRecordsTable() {
      const tbody = document.querySelector('#recordsTable tbody');
      tbody.innerHTML = "";
      records.forEach(record => {
        const row = document.createElement('tr');
        row.innerHTML = `<td>${record.project}</td><td>${record.hours}</td><td>${record.taskType}</td>`;
        tbody.appendChild(row);
      });
    }
    
    function generateMonthlyReport() {
      let reportData = {};
      records.forEach(record => {
        if (!reportData[record.project]) {
          reportData[record.project] = {};
        }
        if (!reportData[record.project][record.taskType]) {
          reportData[record.project][record.taskType] = 0;
        }
        reportData[record.project][record.taskType] += record.hours;
      });
      const tbody = document.querySelector('#monthlyReportTable tbody');
      tbody.innerHTML = "";
      for (const project in reportData) {
        for (const taskType in reportData[project]) {
          const row = document.createElement('tr');
          row.innerHTML = `<td>${project}</td><td>${taskType}</td><td>${reportData[project][taskType]}</td>`;
          tbody.appendChild(row);
        }
      }
    }
    
    function exportTableToCSV(filename) {
      let csv = [];
      const rows = document.querySelectorAll("#monthlyReportTable tr");
      
      rows.forEach(row => {
        const cols = row.querySelectorAll("td, th");
        let rowData = [];
        cols.forEach(col => {
          rowData.push('"' + col.innerText.replace(/"/g, '""') + '"');
        });
        csv.push(rowData.join(","));
      });
      
      const csvString = csv.join("\n");
      const blob = new Blob([csvString], { type: "text/csv" });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.setAttribute("hidden", "");
      a.setAttribute("href", url);
      a.setAttribute("download", filename);
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }
  </script>
  
  <!-- Nuevo Script de Streaming Embebido -->
  <script>
    !function(window){
      const host = "https://labs.heygen.com",
        url = host + "/guest/streaming-embed?share=eyJxdWFsaXR5IjoiaGlnaCIsImF2YXRhck5hbWUiOiIyNDdjNTFjMGM5MDc0NDI3YjNmMWZlNTBm%0D%0AZTJlYTg5YSIsInByZXZpZXdJbWciOiJodHRwczovL2ZpbGVzMi5oZXlnZW4uYWkvYXZhdGFyL3Yz%0D%0ALzI0N2M1MWMwYzkwNzQ0MjdiM2YxZmU1MGZlMmVhODlhL2Z1bGwvMi4yL3ByZXZpZXdfdGFyZ2V0%0D%0ALndlYnAiLCJuZWVkUmVtb3ZlQmFja2dyb3VuZCI6ZmFsc2UsImtub3dsZWRnZUJhc2VJZCI6ImQ3%0D%0AYzVhNmU1YjM2ZDRhZjQ5ZmU5MWYwNDI4Y2YwNmI0IiwidXNlcm5hbWUiOiI5Mzc0NGZkZTc1NGY0%0D%0AY2ZjOTQzNjA2NTU4Y2M3NjZlZSJ9&inIFrame=1",
        clientWidth = document.body.clientWidth,
        wrapDiv = document.createElement("div");
      wrapDiv.id = "heygen-streaming-embed";
      const container = document.createElement("div");
      container.id = "heygen-streaming-container";
      const stylesheet = document.createElement("style");
      stylesheet.innerHTML = `
  #heygen-streaming-embed {
    z-index: 9999;
    position: fixed;
    left: 40px;
    bottom: 40px;
    width: 200px;
    height: 200px;
    border-radius: 50%;
    border: 2px solid #fff;
    box-shadow: 0px 8px 24px 0px rgba(0, 0, 0, 0.12);
    transition: all linear 0.1s;
    overflow: hidden;

    opacity: 0;
    visibility: hidden;
  }
  #heygen-streaming-embed.show {
    opacity: 1;
    visibility: visible;
  }
  #heygen-streaming-embed.expand {
    ${clientWidth < 540 ? "height: 266px; width: 96%; left: 50%; transform: translateX(-50%);" : "height: 366px; width: calc(366px * 16 / 9);"}
    border: 0;
    border-radius: 8px;
  }
  #heygen-streaming-container {
    width: 100%;
    height: 100%;
  }
  #heygen-streaming-container iframe {
    width: 100%;
    height: 100%;
    border: 0;
  }
      `;
      const iframe = document.createElement("iframe");
      iframe.allowFullscreen = !1;
      iframe.title = "Streaming Embed";
      iframe.role = "dialog";
      iframe.allow = "microphone";
      iframe.src = url;
      let visible = !1, initial = !1;
      window.addEventListener("message", (e => {
        e.origin === host && e.data && e.data.type && "streaming-embed" === e.data.type && (
          "init" === e.data.action ? (initial = !0, wrapDiv.classList.toggle("show", initial)) :
          "show" === e.data.action ? (visible = !0, wrapDiv.classList.toggle("expand", visible)) :
          "hide" === e.data.action && (visible = !1, wrapDiv.classList.toggle("expand", visible))
        );
      }));
      container.appendChild(iframe);
      wrapDiv.appendChild(stylesheet);
      wrapDiv.appendChild(container);
      document.body.appendChild(wrapDiv);
    }(globalThis);
  </script>
</body>
</html>
